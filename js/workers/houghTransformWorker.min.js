!function(){"use strict";var t,s,r;return t=function(t){var i,e,o,d,h,g,P,N,v,z,n,a,M,c,f,u,l,I=5*Math.PI/12,y=7*Math.PI/12,p=1*Math.PI/12;for(h=t.length,g=t[0].length,o=(h-1)/2,d=(g-1)/2,P={vert:{distPos:[0,0,0],distNeg:[0,0,0]},horz:{distPos:[0,0,0],distNeg:[0,0,0]}},N=Math.sqrt(o*o+d*d),v=3*Math.PI/N/10,z=function(t,s,r,i){s>=0&&(P[i].distPos[0]+=t*r,P[i].distPos[1]+=s*r,P[i].distPos[2]+=r),0>=s&&(P[i].distNeg[0]+=t*r,P[i].distNeg[1]+=s*r,P[i].distNeg[2]+=r)},i=0;h>i;i+=1)for(e=0;g>e;e+=1)if(t[i]&&t[i][e]&&t[i][e].strength){if(0===t[i][e].direction||45===t[i][e].direction||135===t[i][e].direction)for(n=I;y>n;n+=v)a=(i-o)*Math.cos(n)+(e-d)*Math.sin(n),z(n,a,t[i][e].strength,"horz");if(90===t[i][e].direction||45===t[i][e].direction||135===t[i][e].direction)for(n=-p;p>n;n+=v)a=(i-o)*Math.cos(n)+(e-d)*Math.sin(n),z(n,a,t[i][e].strength,"vert")}return P=r(P,h,g),M=Math.round(s*((P.vert.distPos[0]+P.vert.distNeg[0]-Math.PI/2*(P.horz.distPos[2]+P.horz.distNeg[2])+P.horz.distPos[0]+P.horz.distNeg[0])/(P.vert.distPos[2]+P.vert.distNeg[2]+P.horz.distPos[2]+P.horz.distNeg[2])))/s,c=Math.round(s*(d+P.horz.distPos[1]/P.horz.distPos[2]+P.horz.distNeg[1]/P.horz.distNeg[2]))/s,f=Math.round(s*(o+P.vert.distPos[1]/P.vert.distPos[2]+P.vert.distNeg[1]/P.vert.distNeg[2]))/s,u=Math.round(s*(P.horz.distPos[1]/P.horz.distPos[2]-P.horz.distNeg[1]/P.horz.distNeg[2]))/s,l=Math.round(s*(P.vert.distPos[1]/P.vert.distPos[2]-P.vert.distNeg[1]/P.vert.distNeg[2]))/s,{x0:f,y0:c,width:l,height:u,theta:M,HTscore:P.vert.distPos[2]+P.vert.distNeg[2]+P.horz.distPos[2]+P.horz.distNeg[2],bool:!0}},r=function(t,s,r){var i;return i=JSON.parse(JSON.stringify(t)),0===i.vert.distPos[2]?0===i.vert.distNeg[2]?(t.vert.distPos[1]=s/2,t.vert.distNeg[1]=-s/2,i.vert.distPos[2]=1e-4,i.vert.distNeg[2]=1e-4):(i.vert.distNeg[2]/=100,i.vert.distPos[2]=i.vert.distNeg[2],i.vert.distNeg[1]=-s/4+i.vert.distNeg[1]/2,t.vert.distPos[1]=i.vert.distNeg[1]):0===i.vert.distNeg[2]&&(i.vert.distPos[2]/=100,i.vert.distNeg[2]=i.vert.distPos[2],i.vert.distPos[1]=-s/4+i.vert.distPos[1]/2,t.vert.distNeg[1]=i.vert.distPos[1]),0===i.horz.distPos[2]?0===i.horz.distNeg[2]?(t.horz.distPos[1]=r/2,t.horz.distNeg[1]=-r/2,i.horz.distPos[2]=1e-4,i.horz.distNeg[2]=1e-4):(i.horz.distNeg[2]/=100,i.horz.distPos[2]=i.horz.distNeg[2],i.horz.distNeg[1]=-r/4+i.horz.distNeg[1]/2,t.horz.distPos[1]=i.horz.distNeg[1]):0===i.horz.distNeg[2]&&(i.horz.distPos[2]/=100,i.horz.distNeg[2]=i.horz.distPos[2],i.horz.distPos[1]=-r/4+i.horz.distPos[1]/2,t.horz.distNeg[1]=i.horz.distPos[1]),i},self.onmessage=function(r){var i;s=r.data.roundDigit,i=t(r.data.array),self.postMessage(i)},!1}();