!function(){"use strict";var t,r,n,e,a;return e=67.5*Math.PI/180,a=22.5*Math.PI/180,n=function(r,n){var o,s,i,h,f,g,u,c,d=[],l=[[0,0,0],[0,0,0],[0,0,0]];for(u=r.length,c=r[0].length,f=1;u-1>f;f+=1)for(d[f-1]=[],g=1;c-1>g;g+=1)l[0][0]=r[f-1][g-1],l[1][0]=r[f-0][g-1],l[2][0]=r[f+1][g-1],l[0][1]=r[f-1][g+0],l[2][1]=r[f+1][g+0],l[0][2]=r[f-1][g+1],l[1][2]=r[f+0][g+1],l[2][2]=r[f+1][g+1],s=-1*l[0][0]+1*l[2][0]+-2*l[0][1]+2*l[2][1]+-1*l[0][2]+1*l[2][2],o=-1*l[0][0]+1*l[0][2]+-2*l[1][0]+2*l[1][2]+-1*l[2][0]+1*l[2][2],i=Math.sqrt(s*s+o*o),i=Math.round(i*t)/t,h=Math.atan(o/s),h=-e>h||h>e?0:h>-a&&a>h?90:h>a&&e>h?45:135,i=n>i?0:i,d[f-1][g-1]={strength:i,direction:h};return d},r=function(r,n){var e,a,o,s,i,h,f,g,u,c,d,l=n,m=[],y=0;for(f=r.length,g=r[0].length,a=JSON.parse(JSON.stringify(r)),c=function(t,n,e){t>=0&&f>t&&n>=0&&g>n&&r[t][n].direction===e&&(m.push({x:t,y:n,strength:r[t][n].strength}),y<r[t][n].strength&&(y=r[t][n].strength))},d=function(){m=[],y=0},o=0;f>o;o+=1)for(s=0;g>s;s+=1){switch(e=r[o][s].direction,d(),e){case 0:for(u=-l;l>=u;u+=1)i=o,h=s+u,c(i,h,e);break;case 45:for(u=-l;l>=u;u+=1)i=o+u,h=s+u,c(i,h,e);break;case 90:for(u=-l;l>=u;u+=1)i=o+u,h=s,c(i,h,e);break;default:for(u=-l;l>=u;u+=1)i=o-u,h=s+u,c(i,h,e)}for(u=0;u<m.length;u+=1)r[m[u].x][m[u].y].strength<y-1/t*100&&(a[m[u].x][m[u].y]={strength:0,direction:e})}return a},self.onmessage=function(e){var a,o,s,i,h;a=e.data.non_maximum_suppression,s=e.data.for_hough,o=e.data.array,t=e.data.roundDigit,h=e.data.minimum_edge,i=n(o,h),a&&(i=r(i,a)),self.postMessage(s?{roundDigit:t,array:i}:i)},!1}();