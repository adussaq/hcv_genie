var LINEARFIT=function(){"use strict";var n,r,t,e,o,f,u;return r=function(n){var r=0,t=0,e=0,o=n.length,f=0,u=[],l=[];if(n.length!==n[0].length)return null;for(r=0;r<o;r+=1)for(u[u.length]=[],l[l.length]=[],e=0;e<o;e+=1)u[r][e]=r===e?1:0,l[r][e]=n[r][e];for(r=0;r<o;r+=1){if(0===(f=l[r][r])){for(t=r+1;t<o;t+=1)if(0!==l[t][r]){for(e=0;e<o;e+=1)f=l[r][e],l[r][e]=l[t][e],l[t][e]=f,f=u[r][e],u[r][e]=u[t][e],u[t][e]=f;break}if(0===(f=l[r][r]))return null}for(e=0;e<o;e+=1)l[r][e]=l[r][e]/f,u[r][e]=u[r][e]/f;for(t=0;t<o;t+=1)if(t!==r)for(f=l[t][r],e=0;e<o;e+=1)l[t][e]-=f*l[r][e],u[t][e]-=f*u[r][e]}return u},t=function(n){return n[0].map(function(r,t){return n.map(function(n){return n[t]})})},o=function(n){var r,t,e=!0;for(r=0;r<n.length;r+=1){if(n[r][r].toFixed(5)!==1..toFixed(5)){e=!1;break}for(t=0;t<n.length;t+=1)if(r!==t&&Math.abs(n[r][t]).toFixed(5)!==(0).toFixed(5)){e=!1;break}}return e},e=function(n,r){var t,e,o,f,u=[];for(t=0;t<n.length;t+=1)for(u[t]=[],e=0;e<r[0].length;e+=1){for(f=0,o=0;o<n[0].length;o+=1)f+=n[t][o]*r[o][e];u[t][e]=f}return u},n=function(n){var r,t,e,o=[],f=n.length,u=1<<f;for(t=1;t<u;t+=1){for(r=[],e=0;e<f;e+=1)t&1<<e&&r.push(n[e]);o.push(r)}return o.sort(function(n,r){return r.length-n.length})},u=function(r,t){var e,o,u,l,h,a,i,g,c=[],p=[];for(e=0;e<r[0].length-1;e+=1)c.push(e);for(c=n(c),h=c[0].length,e=0;e<c.length;e+=1){for(h=c[e].length,l=[],o=0;o<r.length;o+=1)for(l[o]=[],u=0;u<h;u+=1)l[o].push(r[o][c[e][u]]);if(a=f(l,t,!1)){for(g=-1,u=0;u<h;u+=1){for(;c[e][u]!==g+1;)a.params.splice(g+1,0,0),g+=1;g+=1}for(u=g+1;u<r[0].length-1;u+=1)a.params.splice(u,0,0)}p.push(a)}for(i={ret:!1,val:0},e=0;e<p.length;e+=1)p[e]&&p[e].R2>i.val&&(i.val=p[e].R2,i.ret=p[e]);return i.ret},f=function(n,f,l){var h,a,i,g,c,p,s,v,m,d=0,F=0;return void 0===l&&(l=!0),n=n.map(function(n){return n.concat(1)}),m=f.map(function(n){return d+=n,[n]}),d/=m.length,i=e(t(n),n),g=r(i),!l&&g&&o(e(g,i))&&o(e(i,g))?(c=e(g,t(n)),a=e(c,m),p=a.map(function(n){return n[0]}),s=n.map(function(n,r){var t,e=0;for(t=0;t<n.length;t+=1)e+=n[t]*p[t];return F+=Math.pow(m[r][0]-d,2),Math.pow(m[r][0]-e,2)}).reduce(function(n,r){return n+r}),h=1-s/F,v={params:p,R2:h,adj_R2:1-(1-h)*(n.length-1)/(n.length-n[0].length-2)},console.log(v,n.length,n[0].length)):l?v=u(n,f):(v=!1,console.log(v,n.length,n[0].length)),v}}();