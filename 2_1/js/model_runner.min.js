var globModel=[];!function(){"use strict";var e,n,t,o,a,i,r,s,l=jQuery,d=!1;n=function(n){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var t,o=new FileReader;o.onload=function(o){t=o.target.result,e(n,t,2)},o.readAsDataURL(n)}else window.alert("The File APIs are not fully supported in this browser.")},e=function(e,n,o){console.log("starting scale:"+o),a.empty(),a.height(""),e.name.match(/\.pdf$/)?hcvGenie.findBands({image:{type:"pdf",pageNumber:1,url:n,scale:o}}).then(t(e,n,o)):hcvGenie.findBands({image:{type:"png",url:n}}).then(t(e,n,o))},i=function(n,t,o,i){globModel.push(n),i+.249<2.5?(e(t,o,i+.249),a.empty(),a.height(""),l("#model").empty()):(d=!1,s.toggleClass("disabled"),r.show())},t=function(e,n,t){return function(r){r.bandingPromise.then(function(a){a.lanePromise.then(function(e){o({canvas:l(r.canvasObject.canvasHolder),all:!1,region:e.region})}),l("#model").append(l("<div>",{class:"col-xs-12 col-sm-4 col-sm-offset-4 col",style:"margin-top:15px"}).append(l("<button>",{text:"Done editing",class:"btn btn-lg btn-primary text-center center-block bottom-buffer"}).click(function(o){o.preventDefault(),l("#model").empty(),a.model_fit_data().then(function(o){i(o,e,n,t)})})))}),a.append(r.canvasObject.canvasHolder),r.canvasObject.canvasHolder.height(r.canvasObject.canvasHolder.children().height())}},o=function(e){var n;n=e.all?function(){a.empty(),a.css("overflow",""),a.css("height",""),a.append(e.canvas.width(a.width()))}:function(){var n,t,o,i,r,s;n=a.width(),o=Math.min(e.region.min[0],e.region.width-e.region.max[0]),i=e.region.width-2*o,t=n/i,r=-1*e.region.min[1]*t,s=(e.region.max[1]-e.region.min[1])*t,a.css("overflow","hidden"),a.css("position","relative"),a.css("height",s),a.attr("class","my-img-thumbnail"),a.append(e.canvas.width(n+2*o*t)),e.canvas.css("margin-top",r),e.canvas.css("margin-left",-o*t)},n(),l(window).unbind("resize"),l(window).resize(n)},function(){var e,t,o=!1;t=l(".computerFile"),s=l(".computerFileButton"),r=l("#drop_model"),a=l("#model_img"),e=document.createElement("span"),(void 0===e.draggable||void 0===e.ondragleave&&void 0===e.ondragover&&void 0===e.ondrop)&&r.parent().empty(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera\ Mini/i.test(navigator.userAgent)&&r.parent().empty(),t.change(function(e){d?e.preventDefault():(d=!0,r.hide(),n(e.target.files[0]),s.toggleClass("disabled"))}),r.on("dragover",function(e){return e.preventDefault(),e.stopPropagation(),o||d||(r.addClass("hover"),o=!0),!1}),r.on("dragleave",function(e){return e.preventDefault(),e.stopPropagation(),r.removeClass("hover"),o=!1,!1}),r.on("drop",function(e){e.preventDefault(),e.stopPropagation(),r.removeClass("hover"),o=!1,d||(s.toggleClass("disabled"),d=!0,r.hide(),n(e.originalEvent.dataTransfer.files[0]))})}()}();